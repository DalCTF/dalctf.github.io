<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="shortcut icon" href="/favicon.ico"><link rel="manifest" href="/site.webmanifest"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#212830"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><title>Data is the new Currency | Writeups | Status 418</title><style>pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
  Theme: GitHub Dark
  Description: Dark theme as seen on github.com
  Author: github.com
  Maintainer: @Hirse
  Updated: 2021-05-15

  Outdated base version: https://github.com/primer/github-syntax-dark
  Current colors taken from GitHub's CSS
*/.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#79c0ff}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-comment,.hljs-code,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}.content[data-astro-cid-tfjleern] a{color:#4985c1}.content[data-astro-cid-tfjleern] p,.content[data-astro-cid-tfjleern] h2{margin-bottom:24px}.content[data-astro-cid-tfjleern] h2 :not(:first-of-type){margin-top:48px}.content[data-astro-cid-tfjleern] img{max-width:100%;border-radius:8px}.content[data-astro-cid-tfjleern] code{background:#171c22;padding:.2em .5em;border-radius:6px;font-size:85%;margin:0;white-space:pre-wrap;word-wrap:break-word;word-break:break-word;overflow-wrap:anywhere}.content[data-astro-cid-tfjleern] pre{background:#171c22;border-radius:8px;margin:24px 0;display:block;padding:16px;white-space:pre-wrap;word-wrap:break-word;word-break:break-word;overflow-wrap:anywhere}.content[data-astro-cid-tfjleern] pre code{padding:0}
</style>
<link rel="stylesheet" href="/_astro/_page_.IxI8udFK.css">
<style>section[data-astro-cid-kggsjsm4]{display:block}[data-astro-cid-kggsjsm4][data-icon]{fill:#ffffffe6}[data-astro-cid-kggsjsm4][data-icon=github]{width:48px;height:48px;padding:8px}[data-astro-cid-kggsjsm4][data-icon=discord]{width:64px;height:64px}[data-astro-cid-kggsjsm4][data-icon=chevron]{width:16px;height:16px}[data-astro-cid-kggsjsm4][data-icon=archive]{width:36px;height:36px;padding:14px}a[data-astro-cid-kggsjsm4]{background:#171c22;justify-content:space-between;border-radius:8px;flex-direction:row;align-items:center;padding:16px;display:flex;color:inherit}a[data-astro-cid-kggsjsm4]:hover .right[data-astro-cid-kggsjsm4]{margin-right:16px}div[data-astro-cid-kggsjsm4]{flex-direction:row;align-items:center;display:flex;gap:16px}.right[data-astro-cid-kggsjsm4]{margin-right:24px;transition:.1s}
.wrapper[data-astro-cid-blwjyjpt]{border:2px solid var(--color);background:var(--background);display:inline-block;border-radius:16px;padding:0 8px;font-weight:500;color:var(--textColor);line-height:1.5rem;font-size:.75rem}
</style></head> <body> <section data-astro-cid-3ef6ksr2> <a class="logo" href="/" data-astro-cid-3ef6ksr2> <img src="/_astro/DalCTF_logo_cleanW.D7mbQLRA_ZwvbxW.webp" alt loading="eager" style="object-fit: contain;" data-astro-cid-3ef6ksr2="true" width="256" height="384" decoding="async"> </a> <div class="links" data-astro-cid-3ef6ksr2> <!-- <div class="dropdown">
      <a href="#" class="dropdown-toggle" role="button">Weekly Problems <span class="arrow">▼</span></a>
      <ul class="dropdown-menu">
        <li><a href="/weekly-problem">This Weeks</a></li>
        <li><a href="/past-weekly-problems">Past Problems</a></li>
      </ul>
    </div> --> <div class="dropdown" data-astro-cid-pqsyg2qg> <a href="#" class="dropdown-toggle" role="button" data-astro-cid-pqsyg2qg> Weekly Problems <span class="arrow" data-astro-cid-pqsyg2qg>▼</span> </a> <ul class="dropdown-menu" data-astro-cid-pqsyg2qg> <li data-astro-cid-pqsyg2qg><a href="/weekly-problem" data-astro-cid-pqsyg2qg>This Week&#39;s Problem(s)</a></li><li data-astro-cid-pqsyg2qg><a href="/past-weekly-problems" data-astro-cid-pqsyg2qg>Past Problems</a></li> </ul> </div>  <a href="/writeups" data-astro-cid-3ef6ksr2>Writeups</a><a href="/competitions" data-astro-cid-3ef6ksr2>Competitions</a> <a class="wrapper" href="https://discord.gg/4vEJJF6CQg" target="_blank" data-astro-cid-vnzlvqnm style="--textColor: #4985C1;--borderColor: #4985C1;--backgroundColor: transparent;"> Join us! </a>  </div> </section>    <section data-astro-cid-bbe6dxrz> <h3 data-astro-cid-bbe6dxrz>CyberSci Regional Qualifiers 2024-25</h3> <h1 data-astro-cid-bbe6dxrz>Data is the new Currency</h1>  <div data-astro-cid-bbe6dxrz>  <div class="tags" data-astro-cid-tfjleern> <p class="wrapper" data-astro-cid-blwjyjpt style="--color: #8000FF;--textColor: #8000FF;--background: transparent;">Forensics</p> </div>  </div> </section>   <section data-astro-cid-kggsjsm4> <a href="https://github.com/DalCTF/CyberSci2024/tree/main/Forensics/DataIsTheNewCurrency" target="_blank" data-astro-cid-kggsjsm4> <div class="left" data-astro-cid-kggsjsm4> <svg width="1.03em" height="1em" data-astro-cid-kggsjsm4="true" data-icon="github">   <symbol id="ai:local:github" viewBox="0 0 98 96"><path fill="currentColor" fill-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a47 47 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0" clip-rule="evenodd"/></symbol><use href="#ai:local:github"></use>  </svg> <p class="emphasis" data-astro-cid-kggsjsm4>View on GitHub</p> </div> <div class="right" data-astro-cid-kggsjsm4> <svg width="0.95em" height="1em" data-astro-cid-kggsjsm4="true" data-icon="chevron">   <symbol id="ai:local:chevron" viewBox="0 0 16 17"><g fill="none"><g clip-path="url(#a)"><path fill="currentColor" d="M13.057 8.48a.78.78 0 0 0-.251-.574L5.93 1.17a.8.8 0 0 0-.573-.226.777.777 0 0 0-.79.79.83.83 0 0 0 .225.565l6.32 6.18-6.32 6.18a.8.8 0 0 0-.225.565c0 .451.347.79.79.79a.78.78 0 0 0 .573-.234l6.875-6.728a.8.8 0 0 0 .251-.573z"/></g><defs><clipPath id="a"><path fill="currentColor" d="M0 .5h16v16H0z"/></clipPath></defs></g></symbol><use href="#ai:local:chevron"></use>  </svg> </div> </a> </section>  <span style="display: block; height: 64px"></span>  <section class="content" data-astro-cid-tfjleern> <div data-astro-cid-tfjleern><h2>Challenge 1</h2>
<p>This is a pcap forensics challenge, and the intructions give the following hint about what to look for:</p>
<pre><code class="hljs">&gt; What file <span class="hljs-keyword">is</span> sent <span class="hljs-keyword">to</span> the customer, who just purchased <span class="hljs-keyword">access</span> <span class="hljs-keyword">to</span> the voter information service? (Answer <span class="hljs-keyword">Format</span> <span class="hljs-keyword">is</span> the <span class="hljs-keyword">full</span> <span class="hljs-type">path</span>)
</code></pre>
<p>So let's look at the PCAP:</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image.png" alt="Initial view of the PCAP"></p>
<p>Initally, we can see some HTTP traffic and unencrypted SMTP traffic. Usually, looking at HTTP traffic is a good place to start, and there are some interesting things in the HTTP streams that we will look at later (mixed with a lot of junk), but first let's check out the emails.</p>
<p>To do this, we will apply a quick filter: <code>smtp</code></p>
<p>From here we can see all the unencrypted emails and go through them. There's a much more readable way to view them however, if we right click on an email and choose <code>Follow &gt; TCP Stream</code> we can get a view of an entire conversation.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-1.png" alt="alt text"></p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-2.png" alt="alt text"></p>
<p>OK, looks like this email has nothing interesting. Most of them have nothing interesting. While solving this challenge I definitely looked at a lot of irrelevant things, and a couple red herrings (flag.zip with a jpeg of... a flag!). Let's see if we can refine our search with info from the problem description. They mention a voter information service, so let's apply the filter:</p>
<pre><code class="hljs">smtp <span class="hljs-keyword">contains</span> <span class="hljs-string">&quot;service&quot;</span>
</code></pre>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-3.png" alt="alt text"></p>
<p>Bingo.</p>
<p>This was enough to get the first flag, but just for completion's sake we can also look for where the client actually downloaded this file. It will be useful in the next part, anyway. Let's apply filter <code>tcp contains &quot;file.zip&quot;</code> and then <code>Follow &gt; TCP Stream</code></p>
<p>Here we can see the HTTP get request where the client downloads the ZIP archive. <img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-4.png" alt="alt text"></p>
<p>This is all that was needed for the first part of the challenge. For the next part, let's work on downloading the contents of this zip file.</p>
<h2>Challenge 2</h2>
<p>The instructions for this part of the challenge say:</p>
<pre><code class="hljs"><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-title class_">Hint</span>: <span class="hljs-title class_">The</span> <span class="hljs-number">2</span> types <span class="hljs-keyword">of</span> crypto used are <span class="hljs-variable constant_">AES</span> <span class="hljs-variable constant_">CBC</span> and <span class="hljs-variable constant_">RSA</span></span>
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-title class_">What</span> is the occupation <span class="hljs-keyword">of</span> <span class="hljs-title class_">Tatiana</span> <span class="hljs-title class_">Castro</span>?</span>
</code></pre>
<p>I can see in the data of the HTTP packet that the ZIP archive contains a client_private_key and a server_public_key. This sounds relevant to the hint that indicates RSA is used, so let's get into this file.</p>
<h3>Step 1 - Extracting file.zip</h3>
<p>Usually the easiest way to download files from a pcap is using <code>File &gt; Export Objects</code>, so that was the first thing I tried.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-5.png" alt="alt text"></p>
<p>Weird, it looks like Wireshark is not detecting file.zip, only flag.zip. I downloaded flag.zip and found a JPEG of the flag of Val Verde (the fictional country that was relevant to the event theme), and tried all the steganography tools in my arsenal, but to no avail. It was a big waste of time.</p>
<p>This was about as far as I got during the actual competition. There were a few other HTTP requests that distracted me, such as a <code>/directory</code> page with a full list of all employees and their professions. Unfortunately there was no Tatiana, and I ran out of time before getting any further.</p>
<p>After the competition, I spoke to a friend on another team who got a little further than I did, and she encouraged me to try harder to export file.zip, and here's how I got there:</p>
<p>If we go back to the HTTP request where the file was downloaded, we can see the full contents of the ZIP archive were transmitted. I know from googling that the header for a ZIP file is <code>PK</code> or, in hex, <code>50 4b</code>. I can see PK in the HTTP packet. So I was thinking, if I can take the hex values of this tranmission and shove it into a file, I should be able to open it.</p>
<p>In Wireshark, change the view mode to &quot;RAW&quot; to show the packet as hex and save the packet as a .zip.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-6.png" alt="alt text"></p>
<p>Now let's open this in a hex editor, GHex.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-8.png" alt="alt text"></p>
<p>Then simply delete everything before the ZIP header and unzip the file.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-7.png" alt="alt text"></p>
<p>Cool. An RSA key. What do we do with it?</p>
<h3>Step 2 - Getting the AES Key</h3>
<p>This next part is where the problem starts to get a little guessy. My first instinct was to use this key to decrypt some of the traffic. Usually you can do this by going to <code>Edit &gt; Preferences &gt; TLS &gt; RSA Keys</code> and adding the key. But there is really no TLS traffic to decrypt here, so what do we do with this key?</p>
<p>After combing through the pcap for way too long looking for anything fishy and not finding much, I went back to the packet where <code>file.zip</code> was downloaded. I decided to filter based on the IPs involved in this exchange, to see if that led anywhere. Let's see what the user did after downloading the keys in the file. The ip of that user is <code>167.78.10.156</code>, so let's apply that as a filter in Wireshark:</p>
<pre><code class="hljs"><span class="hljs-attribute">ip</span>.addr eq <span class="hljs-number">167.78.10.156</span>
</code></pre>
<p>After doing this, there were indeed two conversations in the TCP traffic that could be interesting:</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-9.png" alt="alt text"></p>
<p>One of these looks like a big hex string, and one of them kind of looks like base64. Maybe we can do something with this??? Time to CyberChef.</p>
<p>Couldn't get very far with the stuff on the left, but here's what worked for the hex string on the right:</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-10.png" alt="alt text"></p>
<p>Hell ya. Since the description said AES CBC was used, this must be the AES key.</p>
<h3>Step 3 - Getting the IV</h3>
<p>This is, as far as I know, as far as anyone got on this challenge. From here we can try decrypting the base64 traffic from the other conversation, using the key we just found. The problem is, we don't have the IV. I thought that maybe the hex string that was visible in the file path for the first flag might be it, but no luck. I've tried a few other things but I haven't come across any promising leads.</p>
<p>So this is where we are stuck for now, until the challenge author releases the writeup.</p>
<p><img src="https://github.com/DalCTF/CyberSci2024/raw/main/Forensics/DataIsTheNewCurrency/writeup/image-11.png" alt="alt text"></p>
<p>Even though this is not the most satisfying ending, I hope this writeup was useful for showing you some of the steps that typically go into solving pcap challenges. Wireshark is great B-)</p>
<p>I will update this with the last few steps when they are released, just for completion's sake even though I couldn't get there myself.</p>
</div> </section>  <section data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>
Last Updated in 2025<br data-astro-cid-sz7xmlte>
Halifax, NS<br data-astro-cid-sz7xmlte>
Canada
</p> </section>  </body></html> 